{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React from 'react';\nimport Error from 'next/error';\nimport fetch from 'isomorphic-fetch';\nimport Link from 'next/link';\nimport Router from 'next/Router';\n\nclass Index extends React.Component {\n  static async getInitialProps(context) {\n    const {\n      req,\n      res,\n      query\n    } = context;\n    let page;\n    let stories;\n\n    try {\n      page = Number(query.page) || 1; //      const res = await fetch('http://node-hnapi.herokuapp.com/news?page=1');\n\n      const res = await fetch(`https://jsonkeeper.com/b/IPQF`);\n      stories = await res.json();\n    } catch (e) {\n      console.log('e', e);\n      stories = [];\n    }\n\n    return {\n      stories,\n      page\n    };\n  }\n  /**\n   * Register service worker here\n   */\n\n\n  componentDidMount() {\n    if (\"serviceWorker\" in navigator) {\n      navigator.serviceWorker.register('/service-worker.js') // next doesnt know abt this so will fail. create custom server\n      .then(registration => {\n        console.log('service worker registration success', registration);\n      }).error(err => {\n        console.warn('service worker registration failed', err.message);\n      });\n    }\n  }\n\n  render() {\n    const {\n      stories,\n      page\n    } = this.props;\n\n    if (!stories.length) {\n      return /*#__PURE__*/_jsx(Error, {\n        statusCode: \"503\"\n      });\n    }\n\n    return /*#__PURE__*/_jsxs(_Fragment, {\n      children: [/*#__PURE__*/_jsx(\"span\", {\n        onClick: () => Router.back(),\n        children: \"Back\"\n      }), /*#__PURE__*/_jsx(\"h2\", {\n        children: \"Hacker News\"\n      }), /*#__PURE__*/_jsx(\"h3\", {\n        children: \"PWA on nextjs\"\n      }), /*#__PURE__*/_jsx(\"ul\", {\n        children: stories.map(story => /*#__PURE__*/_jsx(\"li\", {\n          children: story.title\n        }, story.id))\n      }), /*#__PURE__*/_jsx(\"footer\", {\n        children: /*#__PURE__*/_jsx(Link, {\n          href: `/?page=${page + 1}`,\n          children: /*#__PURE__*/_jsxs(\"a\", {\n            children: [\"You are on page \", page, \" click here\"]\n          })\n        })\n      })]\n    });\n  }\n\n}\n\nexport default Index;","map":null,"metadata":{},"sourceType":"module"}